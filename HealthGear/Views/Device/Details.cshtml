@model Device

<h2>Dettagli Dispositivo</h2>

<div class="border p-3 bg-light">
    <dl class="row">
        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Nome</dt>
            <dd class="col-sm-10">@Model.Name</dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Marca</dt>
            <dd class="col-sm-10">@Model.Brand</dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Modello</dt>
            <dd class="col-sm-10">@Model.Model</dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Numero di serie</dt>
            <dd class="col-sm-10">@Model.SerialNumber</dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Ubicazione</dt>
            <dd class="col-sm-10">@Model.Location</dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Prossima manutenzione</dt>
            <dd class="col-sm-10">
                @{
                    var daysUntilNextMaintenance = Model.NextMaintenance.HasValue
                        ? (Model.NextMaintenance.Value - DateTime.Today).Days
                        : -1;
                }
                @if (!Model.NextMaintenance.HasValue)
                {
                    <span class="text-danger">Non disponibile</span>
                }
                else if (daysUntilNextMaintenance < 0)
                {
                    <i class="fas fa-wrench text-danger" title="Scaduta"></i>
                }
                else if (daysUntilNextMaintenance <= 60)
                {
                    <i class="fas fa-wrench text-warning" title="In scadenza"></i>
                }
                else
                {
                    <i class="fas fa-wrench text-success" title="Valida"></i>
                }
            </dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Prossima verifica elettrica</dt>
            <dd class="col-sm-10">
                @{
                    var daysUntilNextElectricalTest = Model.NextElectricalTest.HasValue
                        ? (Model.NextElectricalTest.Value - DateTime.Today).Days
                        : -1;
                }
                @if (!Model.NextElectricalTest.HasValue)
                {
                    <span class="text-danger">Non disponibile</span>
                }
                else if (daysUntilNextElectricalTest < 0)
                {
                    <i class="fas fa-bolt text-danger" title="Scaduta"></i>
                }
                else if (daysUntilNextElectricalTest <= 60)
                {
                    <i class="fas fa-bolt text-warning" title="In scadenza"></i>
                }
                else
                {
                    <i class="fas fa-bolt text-success" title="Valida"></i>
                }
            </dd>
        </div>

        <div class="border-bottom pb-2 mb-3">
            <dt class="col-sm-2 font-weight-bold">Note</dt>
            <dd class="col-sm-10">@(!string.IsNullOrEmpty(Model.Notes) ? Model.Notes : "Nessuna nota")</dd>
        </div>
    </dl>
</div>

<h3>Gestione Manutenzioni e Verifiche</h3>

<a asp-controller="Maintenance" asp-action="Create" asp-route-deviceId="@Model.Id" class="btn btn-primary">
    Aggiungi Manutenzione
</a>

<a asp-controller="ElectricalTest" asp-action="Create" asp-route-deviceId="@Model.Id" class="btn btn-info">
    Gestisci Verifiche Elettriche
</a>

<a asp-controller="PhysicalInspection" asp-action="Create" asp-route-deviceId="@Model.Id" class="btn btn-success">
    Gestisci Controlli Fisici
</a>


<div class="mt-4">
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">Modifica</a>
    <a asp-action="Index" class="btn btn-secondary">Torna alla lista</a>

    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteModal">
        Elimina
    </button>
</div>

<!-- Modal di conferma eliminazione -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Conferma Eliminazione</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Chiudi">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Sei sicuro di voler eliminare questo dispositivo? Questa azione non pu√≤ essere annullata.
            </div>
            <div class="modal-footer">
                <form asp-action="Delete" asp-route-id="@Model.Id" method="post">
                    <button type="submit" class="btn btn-danger">Conferma Eliminazione</button>
                </form>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
            </div>
        </div>
    </div>
</div>
